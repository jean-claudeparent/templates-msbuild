<Project DefaultTargets="main">

<PropertyGroup>
    <PrefixeSource>D:\DevCenter\build\TempBuild\</PrefixeSource>
    <OutputType>Dll</OutputType>
    <repository>d:\Devcenter\sources\</repository>
     <Logiciel>MokaDocos</Logiciel>
    <VersionLogiciel>0.1.1</VersionLogiciel>
    <OutputDirectory>d:\Devcenter\build\TempBuild\bin\$(Logiciel)\$(VersionLogiciel)\lib\</OutputDirectory>
</PropertyGroup>

<ItemGroup>
    <Compile Include="*\*.cs"/>
    <Compile Include="*.cs"/>
</ItemGroup>
  <ItemGroup>
    <None Remove=".DS_Store" />
    <None Remove="MokaDocos-gabarit.html" />
  </ItemGroup>
  <ItemGroup>
    <None Update="MokaDocos-License.txt">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </None>
    <None Update="MokaDocos-gabarit.html">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
  </ItemGroup>
  <ItemGroup>
    <Content Include="MokaDocos-gabarit.html">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </Content>
  </ItemGroup>


<Target Name="main">
  <CallTarget Targets="extrairesources" />
  <CallTarget Targets="MokaDocosnet45" />
</Target>

<Target Name="extrairesources">
<PropertyGroup>
  <CodeSourceRepo>$(repository)$(Logiciel)\</CodeSourceRepo> 
  <BuildCodeSource>$(PrefixeSource)\sources\MokaDocos</BuildCodeSource> 
</PropertyGroup>
<ItemGroup>
    <MesFichiersSource Include="$(CodeSourceRepo)*.cs"/>
   <MesFichiersSource Include="$(CodeSourceRepo)*\*.cs" />
   <MesFichiersSource Include="$(CodeSourceRepo)*.htm*"/>
   <MesFichiersSource Include="$(CodeSourceRepo)*\*.htm*"/>
</ItemGroup>
<RemoveDir  Directories="$(BuildSource)" />
  <MakeDir  Directories="$(BuildSource)" />
  
<Message Text="Extraire les sources de : @(MesFichiersSource->'$(BuildCodeSource)\%(RecursiveDir)%(Filename)%(Extension)')" />
<Copy
   SourceFiles="@(MesFichiersSource)"
   DestinationFiles="@(MesFichiersSource->'$(BuildCodeSource)\%(RecursiveDir)%(Filename)%(Extension)')" />
</Target>

<Target Name="MokaDocosnet45">
 <PropertyGroup>
  <TargetFramework>net45</TargetFramework>
  <NugetOutputLib>$(OutputDirectory)$(TargetFramework)\</NugetOutputLib>
 </PropertyGroup>
 
  

  <Message Text="Builder : $(NugetOutputLib)" />
  
  <csc Sources="@(Compile)"
     OutputAssembly="$(NugetOutputLib)\$(Logiciel).dll"
     EmitDebugInformation="false"  />

</Target>
</Project>
